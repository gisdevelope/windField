function createOverlay(a){function b(w){var z=e[0]+g*w[0],A=f[0]+h*w[1];return[A,z]}for(var c=formatDate(a),e=c[0].map(function(w){return w.x}),f=c.map(function(w){return w[0].y}),g=e[1]-e[0],h=f[1]-f[0],k=c.map(function(w){return w.map(function(z){return z.v})}),l=[],m=0;40>=m;m+=2)l.push(m);for(var n=d3.scaleLinear().domain([l[0],15,l[l.length-1]]).range([d3.rgb(0,0,0,0.05),d3.rgb(200,0,150,0.3),d3.rgb(200,0,150,0.5)]),o=[],q=1;q<l.length;q++){var r=l[q-1],s=l[q],t=MarchingSquaresJS.IsoBands(k,r,s-r);if(t.length){var u=t.map(function(w){return w.map(function(z){return b(z)})});o.push({coords:u,color:n(q),val:l[q]})}}return{isoBands:o,draw:function draw(w,z){var A=w.getContext('2d'),B=z.latLngToContainerPoint([0,180]),C=z.latLngToContainerPoint([0,-180]),D=B.x-C.x,E=[];B.x<w.width&&E.push(D),0<C.x&&E.push(-D);var F=function(G){return function(H){var I=z.latLngToContainerPoint(H);return[I.x+G,I.y]}};o.forEach(function(G){E.forEach(function(H){var I=createPath(G.coords,F(H));A.fillStyle=G.color,A.fill(I,'evenodd')})})}}}function formatDate(a){var b=a.field,c=Math.abs(a.x1-a.x0)/(a.w-1),e=Math.abs(a.y1-a.y0)/(a.h-1),f=[];return b.forEach(function(g,h){g.forEach(function(k,l){var m=Math.sqrt(Math.pow(k.x,2)+Math.pow(k.y,2));f[l]||(f[l]=[]),f[l][h]={x:a.x0+c*h,y:a.y0+e*l,v:m}})}),f}function createPath(a,b){var c='';return a.forEach(function(e){e.forEach(function(f,g){var h=b(f);c+=0===g?'M':'L',c+=h[0]+','+h[1],g===e.length-1&&(c+='Z')})}),new Path2D(c)}
